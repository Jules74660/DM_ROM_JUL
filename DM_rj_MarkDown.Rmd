---
title: ""
output: 
  html_document:
    theme: cosmo
    toc: true
    toc_float: true
  pdf_document:
    toc: true
---


::: {style="background-color: black; padding: 12px; border-radius: 5px; text-align: center; margin-bottom: 20px;"}
<strong style="color: white; font-size: 2.3em;">
  Élaboration d’un plan d’échantillonnage GRTS : cas du Crapaud Buffle (*Rhinella marina*) <br>
</strong>
:::


::: {style="color: darkblue; font-size: 1.2em;"}
## Contexte et objectifs
:::

<hr style="border:2px solid gray">

La mise en place d'un plan d'échantillonnage est une étape cruciale dans la collecte de données écologiques. Elle permet de garantir que les échantillons recueillis sont représentatifs de la population étudiée, tout en optimisant les ressources disponibles. Parmi les différentes méthodes d'échantillonnage, le GRTS (Generalized Random Tessellation Stratified) se distingue par sa capacité à fournir un échantillonnage spatialement équilibré, ce qui est particulièrement utile dans les études environnementales où la distribution spatiale des espèces peut être hétérogène.

Dans ce document nous explorons la mise en place d'un plan d'échantillonnage GRTS pour le suivi du crapaud buffle (*Rhinella marina*) en Guadeloupe. Ce choix est motivé par la nécessité de surveiller cette espèce invasive, qui a des impacts significatifs sur les écosystèmes locaux. En utilisant la base de données Corine Land Cover, nous identifions les types de couverture des sols présents sur l'île, ce qui nous permet de stratifier notre échantillonnage en fonction des habitats majeurs.

::: {style="color: darkblue; font-size: 1.2em;"}
## Chargement des packages
:::

```{r chargement des packages, echo=TRUE, message=FALSE, warnings=FALSE}

pacman::p_load(tidyverse, spsurvey, cartography, readxl, viridisLite, sf)

```

# I. Importation du .shp et association du type de couverture des sols via la nomenclature

<hr style="border:2px solid gray">


```{r setup, include=FALSE, echo=FALSE, message=FALSE}

getwd() # si on ouvre avec le r.proj on devrait avoir le bon chemin sinon on copie colle le résultat

Chemin <- "/Users/jules/Desktop/Master/M2/strategie_echantillonage/DM_ROM_JUL"
setwd(Chemin)

```

::: {style="color: darkblue; font-size: 1.2em;"}
## Importation des données via data.gouv.fr
:::

```{r source des données, echo=TRUE, message=FALSE, warnings=FALSE, eval=FALSE}

download.file('http://www.donnees.statistiques.developpement-durable.gouv.fr/donneesCLC/CLC/region/CLC_D971_UTM_SHP.zip', destfile = 'CLC')
unzip('CLC')

```

::: {style="color: darkblue; font-size: 1.2em;"}
## Chargement des données nécessaires
:::

```{r import, echo=TRUE, message=FALSE, warning=FALSE}

# Nomenclature

nomenclature <- readxl::read_excel("CLC_D971_UTM_SHP/CLC_nomenclature.xls", sheet = 4)

# Shapefile de la couverture des sols

# Recensement année 2000
couv2000 <- st_read("CLC_D971_UTM_SHP/CLC00/CLC00_D971_UTM.shp", quiet = TRUE)

# Recensement année 2006
couv2006 <- st_read("CLC_D971_UTM_SHP/CLC06/CLC06_D971_UTM.shp", quiet = TRUE)

# Recensement année 2012
couv2012 <- st_read("CLC_D971_UTM_SHP/CLC12/CLC12_D971_UTM.shp", quiet = TRUE)

```

::: {style="color: darkblue; font-size: 1.2em;"}
## Association des types de sols au shapefile
:::

```{r association colonne type de sol, echo=TRUE, message=FALSE, warning=FALSE}

couv2000 <- left_join(couv2000, nomenclature, by = c("CODE_00" = "code_clc_niveau_4"))
couv2006 <- left_join(couv2006, nomenclature, by = c("CODE_06" = "code_clc_niveau_4"))
couv2012 <- left_join(couv2012, nomenclature, by = c("CODE_12" = "code_clc_niveau_4"))
```

```{r création de la population statistique, echo=FALSE, message=FALSE, include=FALSE, warning=FALSE}

couv2000 <- couv2000 %>%
  group_by(CODE_00, libelle_fr) %>%
  summarise(AREA_HA = sum(AREA_HA, na.rm = TRUE), .groups = "drop") %>%
  filter(AREA_HA >= 500) %>% 
  filter(CODE_00 != "5230")

couv2006 <- couv2006 %>%
  group_by(CODE_06, libelle_fr) %>%
  summarise(AREA_HA = sum(AREA_HA, na.rm = TRUE), .groups = "drop") %>%
  filter(AREA_HA >= 500) %>% 
  filter(CODE_06 != "5230")

couv2012 <- couv2012 %>%
  group_by(CODE_12, libelle_fr) %>%
  summarise(AREA_HA = sum(AREA_HA, na.rm = TRUE), .groups = "drop") %>%
  filter(AREA_HA >= 500) %>% 
  filter(CODE_12 != "5230")

```

# II. Cartographie de la typologie des sols {.tabset}

<hr style="border:2px solid gray">

::: {style="color: darkblue; font-size: 1.2em;"}
## 2000
:::

```{r carte couverture des sols 2000}

# >500 hors code mers et océan

couvcarte <- st_read("CLC_D971_UTM_SHP/CLC12/CHA12_D971_UTM.shp")
couvcarte <- couvcarte %>% filter(CODE_12 != "5")

ggplot() +
  geom_sf(data = couvcarte, fill = "grey") +
  geom_sf(data = couv2012, aes(fill = libelle_fr), color = NA) +
  scale_fill_viridis_d(option = "D", name = "Type de couverture des sols") +
  theme_minimal() +
  labs(title = "Couverture des sols en Guadeloupe",
       subtitle = "Données Corine Land Cover 2000",
       caption = "Source : data.gouv.fr") +
  theme(legend.position = "bottom")

```

::: {style="color: darkblue; font-size: 1.2em;"}
## 2006
:::

::: {style="color: darkblue; font-size: 1.2em;"}
## 2012
:::

# {-}

# III. Création de la population statistique

<hr style="border:2px solid gray">

```{r création de la population statistique visible, echo=FALSE, message=FALSE, warning=FALSE}

couv2000 <- couv2000 %>%
  group_by(CODE_00, libelle_fr) %>%
  summarise(AREA_HA = sum(AREA_HA, na.rm = TRUE), .groups = "drop") %>%
  filter(AREA_HA >= 500) %>% 
  filter(CODE_00 != "5230")

couv2006 <- couv2006 %>%
  group_by(CODE_06, libelle_fr) %>%
  summarise(AREA_HA = sum(AREA_HA, na.rm = TRUE), .groups = "drop") %>%
  filter(AREA_HA >= 500) %>% 
  filter(CODE_06 != "5230")

couv2012 <- couv2012 %>%
  group_by(CODE_12, libelle_fr) %>%
  summarise(AREA_HA = sum(AREA_HA, na.rm = TRUE), .groups = "drop") %>%
  filter(AREA_HA >= 500) %>% 
  filter(CODE_12 != "5230")

```

# IV. GRTS

<hr style="border:2px solid gray">



C'est une valeur arbitraire mais on justifie ce nombre par le fait que l'on veut un nombre d'échantillons gérable en 6 mois de stage.

On fait un GRTS car ...... 

::: {style="color: darkblue; font-size: 1.2em;"}
## tableau des points avec coordonnées
:::

# V. Cartographie via QGIS 

<hr style="border:2px solid gray">

::: {style="color: darkblue; font-size: 1.2em;"}
## Limite du plan d'échantillonnage
:::


::: {style="display: flex; gap: 20px; align-items: center;"}
![](Capture d’écran 2024-10-05 à 08.59.10.png){width="180"}
:::

